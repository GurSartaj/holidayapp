<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="config.js"></script>
    <script src="utils.js"></script>
    <script src="data-manager.js"></script>
    <script src="calendar.js"></script>

    <script src="ui-components.js"></script>
    <script src="dashboard.js"></script>
    <script src="annual-dashboard.js?v=2"></script>
    <script src="google-sheets-integration.js"></script>
    <script src="script.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <title>Team Holiday Tracker</title>
    <!-- Swiper's CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <link rel="stylesheet" href="styles.css" />
</head>

<body>

    <header class="app-header">
        <div class="header-left">
            <span class="app-icon">ğŸ“†</span>
            <h1 class="app-title">Team Holiday Tracker</h1>
        </div>
        <div class="header-center">
            <div id="currentUserDisplay" class="header-notice">
                <span class="notice-icon">â„¹ï¸</span>
                Currently editing holidays for:
                <strong>
                    <span id="currentUserName">None</span>
                </strong>
            </div>
            <div class="member-select-container">
                <label for="userSelect">
                    <strong>Select Team Member:</strong>
                </label>
                <select id="userSelect" class="member-dropdown">
                    <!-- Options are dynamically populated by JavaScript --></select>
            </div>
        </div>
        <div class="header-right">
            <!-- Only tabs here now -->
            <nav class="nav-tabs">
                <div class="tab active" id="tab-calendar" onclick="switchTab('calendarTab')">
                    Holiday Entry
                </div>
                <div class="tab" id="tab-dashboard" onclick="switchTab('dashboardTab')">
                    Dashboard
                </div>
                <div class="tab" id="tab-admin" onclick="switchTab('adminTab')">
                    Admin
                </div>
            </nav>
        </div>
    </header>
    <div id="mainContent">
        <div id="calendarTab" class="tab-content">
            <!-- ADD THIS ENTIRE SECTION HERE -->
            <div class="quick-stats-container">
                <div class="quick-stat-pill team-size">
                    <div class="pill-icon">ğŸ‘¥</div>
                    <div class="pill-content">
                        <div class="pill-value" id="stat-team-size">10</div>
                        <div class="pill-label">Team</div>
                    </div>
                </div>
                <div class="quick-stat-pill on-holiday">
                    <div class="pill-icon">ğŸ–ï¸</div>
                    <div class="pill-content">
                        <div class="pill-value" id="stat-on-holiday">4</div>
                        <div class="pill-label">On Holiday</div>
                    </div>
                </div>
                <div class="quick-stat-pill availability">
                    <div class="pill-icon">âœ…</div>
                    <div class="pill-content">
                        <div class="pill-value" id="stat-availability">83%</div>
                        <div class="pill-label">Available</div>
                    </div>
                </div>
                <div class="quick-stat-pill birthdays">
                    <div class="pill-icon">ğŸ‚</div>
                    <div class="pill-content">
                        <div class="pill-value" id="stat-birthdays">2</div>
                        <div class="pill-label">Birthdays</div>
                    </div>
                </div>
                <div class="quick-stat-pill anniversaries">
                    <div class="pill-icon">ğŸ‰</div>
                    <div class="pill-content">
                        <div class="pill-value" id="stat-anniversaries">1</div>
                        <div class="pill-label">Anniversaries</div>
                    </div>
                </div>
                <div class="quick-stat-pill off-today">
                    <div class="pill-icon">ğŸ </div>
                    <div class="pill-content">
                        <div class="pill-value" id="stat-off-today">2</div>
                        <div class="pill-label">Off Today</div>
                    </div>
                </div>
            </div>
            <!-- END OF ADDED SECTION -->
            <div class="calendar-flex-row">
                <div class="card" style="
              flex: 1;
              min-width: 340px;
              margin: 0 auto;
              padding-bottom: 8px;
            ">
                    <div class="month-selector pretty-nav">
                        <button class="nav-btn" id="prevBtn">â€¹</button>

                        <!-- make the title a focusable button-like element -->
                        <div id="monthYearDisplay" class="month-label" role="button" tabindex="0"
                            title="Jump to a date"></div>

                        <button class="nav-btn" id="nextBtn">â€º</button>

                        <!-- jump-to popover -->
                        <div id="jumpPopover" class="jump-popover" hidden>
                            <div class="jp-title">Jump toâ€¦</div>

                            <div class="jp-row">
                                <label class="jp-label" for="goDate">Go to date</label>
                                <input id="goDate" class="jp-input" type="date">
                            </div>

                            <div class="jp-actions">
                                <button id="btnToday" class="jp-btn">Today</button>
                                <button id="btnGo" class="jp-btn primary">Go</button>
                            </div>
                        </div>
                    </div>

                    <div id="calendar" class="calendar holiday-entry-calendar"></div>
                    <div class="confetti" id="confetti"></div>
                    <!-- ADD THIS LEGEND -->
                    <div class="calendar-legend-single">
                        <div class="legend-group">
                            <span class="text-item">Left Click: <span class="text-icon icon-full"></span>Full</span>
                            <span class="text-item">Right Click: <span class="text-icon icon-morning"></span>AM/<span
                                    class="text-icon icon-afternoon"></span>PM</span>
                        </div>

                        <div class="legend-group">
                            <span class="text-item">Holidays: <span class="text-icon icon-uk"></span>UK <span
                                    class="text-icon icon-us"></span>US <span class="text-icon icon-india"></span>IN
                                <span class="text-icon icon-custom"></span>Custom</span>
                        </div>

                        <div class="legend-group">
                            <span class="text-item">Special: ğŸ‚ Birthdays ğŸ† Anniversaries</span>
                        </div>
                    </div>

                    <div style="
                display: flex;
                gap: 12px;
                justify-content: center;
                margin: 4px 0;
              ">
                        <button id="saveBtn" class="save-btn">Save Holidays</button>
                        <button id="clearBtn" class="save-btn" style="background: #033efd">
                            Clear Holidays
                        </button>
                    </div>
                </div>
            </div>
            <!-- â†“â€”â€” INSERT MONTHLY GANTT HERE â€”â€”â†“ -->
            <div class="gantt-header-container">
                <div class="gantt-header-inner">
                    <div class="gantt-header-with-toggle">
                        <h2 class="gantt-main-title">Full Team Monthly Overview</h2>
                        <button class="toggle-gantt-btn" id="ganttToggleBtn" onclick="toggleGanttView()">
                            <span id="ganttEyeIcon">ğŸ‘ï¸</span>
                            <span id="ganttToggleText">Show</span>
                            <span class="gantt-arrow" id="ganttArrow">â–¼</span>
                        </button>
                    </div>
                </div>
            </div>
            <div id="ganttContainer" class="gantt-collapsible-container collapsed">
                <div id="monthlyGantt" class="gantt-table-container"></div>
                <div id="ganttLegendRow" style="
            display: flex;
            gap: 18px;
            margin: 16px auto 0;
            font-size: 13px;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            max-width: 900px;
          ">
                    <span>
                        <span style="
                display: inline-block;
                width: 18px;
                height: 18px;
                border-radius: 4px;
                background: #1976d2;
                margin-right: 5px;
                vertical-align: middle;
              "></span>
                        UK Holiday
                    </span>
                    <span>
                        <span style="
                display: inline-block;
                width: 18px;
                height: 18px;
                border-radius: 4px;
                background: #ef6c00;
                margin-right: 5px;
                vertical-align: middle;
              "></span>
                        US Holiday
                    </span>
                    <span>
                        <span style="
                display: inline-block;
                width: 18px;
                height: 18px;
                border-radius: 4px;
                background: #ececec;
                margin-right: 5px;
                vertical-align: middle;
                border: 1px solid #bbb;
              "></span>
                        Weekend
                    </span>
                    <span>
                        <span style="
                display: inline-block;
                width: 18px;
                height: 18px;
                border-radius: 4px;
                background: #fff;
                margin-right: 5px;
                vertical-align: middle;
                border: 1px solid #ccc;
              "></span>
                        Available
                    </span>
                    <span>
                        Team:
                        <span id="legendMembers"></span>
                    </span>
                </div>
            </div>
        </div>
        <!-- END of #calendarTab -->
        <!-- Dashboard Tab (hidden by default) -->
        <div id="dashboardTab" class="tab-content hidden">
            <!-- 1) Header & Controls -->
            <div class="dashboard-header">
                <h2>ğŸ“† Monthly Absence Dashboard</h2>
                <div class="controls">
                    <select id="teamFilter">
                        <option>All Teams</option>
                        <!-- later populate with real teams -->
                    </select>
                    <select id="monthFilter">
                        <option>July 2025</option>
                        <!-- autopopulate or hardcode months -->
                    </select>
                </div>
            </div>

            <!-- Dashboard View Toggle -->
            <div class="dashboard-view-toggle">
                <button class="view-toggle-btn active" id="monthlyViewBtn" onclick="switchDashboardView('monthly')">
                    ğŸ“… Monthly View
                </button>
                <button class="view-toggle-btn" id="annualViewBtn" onclick="switchDashboardView('annual')">
                    ğŸ“Š Annual View
                </button>
            </div>


            <!-- Monthly Dashboard View -->
            <div id="monthlyDashboardView" class="dashboard-view active">

                <!-- 2) KPI Row -->
                <div class="dashboard-kpis-grid">
                    <div class="kpi-card trend">
                        <div class="kpi-icon">ğŸ“…</div>
                        <div class="kpi-value" id="kpi-total-leave">â€“</div>
                        <div class="kpi-label">Total Leave Days</div>
                        <div class="kpi-subtext" id="kpi-total-leave-change"></div>
                    </div>
                    <div class="kpi-card success">
                        <div class="kpi-icon">ğŸ™‹â€â™‚ï¸</div>
                        <div class="kpi-value" id="kpi-avg-leave">â€“</div>
                        <div class="kpi-label">Avg Days Off/Person</div>
                    </div>
                    <div class="kpi-card warning">
                        <div class="kpi-icon">âœ…</div>
                        <div class="kpi-value" id="kpi-avail-pct">â€“%</div>
                        <div class="kpi-label">Working Days Available</div>
                    </div>
                    <div class="kpi-card danger">
                        <div class="kpi-icon">ğŸš¨</div>
                        <div class="kpi-value" id="kpi-off-today">â€“</div>
                        <div class="kpi-label">Off Today</div>
                    </div>
                    <div class="kpi-card info">
                        <div class="kpi-icon">âš¡</div>
                        <div class="kpi-value" id="kpi-at-risk">â€“</div>
                        <div class="kpi-label">At-Risk Days</div>
                        <div id="kpi-at-risk-list" style="font-size: 0.93em; margin-top: 2px"></div>
                    </div>
                    <div class="kpi-card success">
                        <div class="kpi-icon">ğŸŒŸ</div>
                        <div class="kpi-value" id="kpi-zero-leave-days">â€“</div>
                        <div class="kpi-label">Days with Zero Leave</div>
                        <div id="kpi-zero-leave-msg" style="font-size:0.92em;margin-top:2px;"></div>
                        <div class="kpi-subtext" style="font-size: 0.89em; opacity: 0.8; color: #666">
                            (excludes weekends and public holidays)
                        </div>
                    </div>
                    <div class="kpi-card info">
                        <div class="kpi-icon">ğŸŸ©</div>
                        <div class="kpi-value" id="kpi-no-leave-members">â€“</div>
                        <div class="kpi-label">No Leave Takers</div>
                        <div class="kpi-subtext" id="kpi-no-leave-members-list" style="
                font-size: 0.95em;
                opacity: 0.8;
                color: #1976d2;
                margin-top: 4px;
              "></div>
                    </div>
                    <!-- Upcoming Leave (7-day) -->
                    <div class="kpi-card info">
                        <div class="kpi-icon">ğŸ—“ï¸</div>
                        <div class="kpi-value" id="kpi-upcoming-leave">â€”</div>
                        <div class="kpi-label">Upcoming Leave (7-day)</div>
                        <div class="kpi-subtext" id="kpi-upcoming-leave-names" style="margin-top:8px;"></div>
                    </div>
                    <div class="kpi-card" id="kpi-top-leave-card">
                        <div class="kpi-icon">ğŸ†</div>
                        <div class="kpi-value" id="kpi-top-leave-num">â€“</div>
                        <div class="kpi-label">Top Leave Takers</div>
                        <div class="kpi-subtext" id="kpi-top-leave-names" style="margin-top:8px;"></div>
                    </div>
                    <!-- On Leave This Month -->
                    <div class="kpi-card info">
                        <div class="kpi-icon">ğŸ“…</div>
                        <div class="kpi-value" id="kpi-month-leave-num">â€”</div>
                        <div class="kpi-label">On Leave This Month</div>
                        <div class="kpi-subtext" id="kpi-month-leave-names" style="margin-top:8px;"></div>
                    </div>
                    <!-- ADD THIS NEW CARD HERE -->
                    <div class="kpi-card special-dates">
                        <div class="kpi-icon">ğŸ‚</div>
                        <div class="kpi-value" id="kpi-special-dates">â€”</div>
                        <div class="kpi-label">Special Dates This Month</div>
                        <div class="special-dates-list" id="kpi-special-dates-list">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>
                    <!-- Monthly Leave Trend -->
                    <div class="kpi-card info">
                        <div class="kpi-icon">ğŸ“ˆ</div>
                        <div class="kpi-value" id="kpi-monthly-trend">â€”</div>
                        <div class="kpi-label">Monthly Leave Trend</div>
                    </div>
                    <!-- Request Growth Rate -->
                    <div class="kpi-card info" style="display:none;">
                        <div class="kpi-icon">ğŸ“Š</div>
                        <div class="kpi-value" id="kpi-request-growth">â€”</div>
                        <div class="kpi-label">Request Growth Rate</div>
                    </div>
                </div>
                <!-- NEW: Combined side-by-side layout -->
                <!-- Replace both the 6-month chart and heatmap sections with this -->
                <div class="dashboard-two-charts">
                    <!-- Left: 6-Month Rolling Chart -->
                    <div class="dashboard-chart-half">
                        <div class="chart-label">6-Month Rolling Leave Trend (by Member)</div>
                        <canvas id="multiMemberLeaveTrendChart"></canvas>
                    </div>

                    <!-- Right: Absence Calendar -->
                    <div class="dashboard-chart-half">
                        <div class="chart-label">Absence Calendar</div>
                        <div id="calendarHeatmapFull" class="heatmap heatmap-classy-5"></div>
                    </div>
                </div> <!-- 3) Miniâ€Charts Grid -->
                <div class="dashboard-charts-grid">
                    <!-- Share of Leave (donut) -->
                    <div class="chart-card">
                        <canvas id="leaveShareChart"></canvas>
                        <div class="chart-label">Share of Leave by Member</div>
                    </div>
                    <!-- Daily Availability sparkline -->
                    <div class="chart-card">
                        <canvas id="dailyAvailChart"></canvas>
                        <div class="chart-label">Daily Availability</div>
                    </div>
                    <!-- Weekly Availability bar -->
                    <div class="chart-card">
                        <canvas id="weeklyAvailChart"></canvas>
                        <div class="chart-label">Weekly Availability</div>
                    </div>
                    <!-- Cumulative Leave Trend -->
                    <div class="chart-card">
                        <canvas id="cumulativeTrendChart"></canvas>
                        <div class="chart-label">Leave Days by Member</div>
                    </div>
                </div>

                <!-- Risk KPI Card
      <div class="kpi-card risk-kpi" id="riskCard">
        <div id="riskKpiContent"></div>
      </div> -->
                <!-- 6) Footer Actions -->
                <div class="dashboard-footer">
                    <button id="downloadCSV">Download CSV</button>
                    <button id="copyLink">Copy Shareable Link</button>
                </div>
            </div>
            <!-- Annual Dashboard View -->
            <div id="annualDashboardView" class="dashboard-view hidden">

                <!-- Add this right after the dashboard-view-toggle div -->
                <div class="annual-member-filter-container">
                    <div class="filter-header">
                        <h3>ğŸ“Š Analyze Individual Performance</h3>
                        <p>Select a team member to see their personal annual insights vs team averages</p>
                    </div>

                    <div class="member-filter-controls">
                        <label for="annualMemberSelect" class="filter-label">
                            <strong>View Data For:</strong>
                        </label>
                        <select id="annualMemberSelect" class="annual-member-dropdown"
                            onchange="onAnnualMemberFilterChange()">
                            <option value="">ğŸ¢ All Team (Default)</option>
                        </select>
                        <button class="reset-team-view-btn" onclick="resetAnnualMemberFilter()"
                            style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); color: white; border: none; padding: 10px 20px; border-radius: 8px; font-weight: 600; cursor: pointer;">
                            ğŸ”„ Reset to Team View
                        </button>

                        <div class="filter-status" id="annualFilterStatus">
                            <span class="status-icon">ğŸ‘¥</span>
                            Showing data for: <strong>Entire Team</strong>
                        </div>
                    </div>
                </div>

                <div class="dashboard-kpis-grid">
                    <!-- Annual KPI cards will be added here by JavaScript -->
                </div>

                <div class="dashboard-charts-grid">
                    <!-- Annual charts will be added here by JavaScript -->
                </div>
            </div>
            <!-- End Annual Dashboard View -->
        </div>
        <!-- END of #dashboardTab -->

        <!-- Admin Tab (hidden by default) -->
        <div id="adminTab" class="tab-content hidden">
            <div class="advanced-admin-card">
                <!-- Mode Selector -->
                <div class="admin-mode-selector">
                    <button class="admin-mode-tab active" onclick="switchAdminMode(this, 'holidays-admin')">
                        ğŸ‰ Custom Holidays
                    </button>
                    <button class="admin-mode-tab" onclick="switchAdminMode(this, 'members-admin')">
                        ğŸ‘¥ Team Members
                    </button>
                    <button class="admin-mode-tab" onclick="switchAdminMode(this, 'special-admin')">
                        ğŸ‚ Special Dates
                    </button>
                </div>
                <!-- Mode Content -->
                <div class="admin-mode-content">
                    <!-- Custom Holidays Mode -->
                    <div id="holidays-admin" class="admin-mode-pane active">
                        <div class="holiday-creator-container">
                            <div class="header">
                                <h2>ğŸ‰ Create Holiday</h2>
                                <p>Custom holidays or public holidays for any region</p>
                            </div>

                            <!-- Holiday Name -->
                            <div class="form-section">
                                <label class="form-label">Holiday Name</label>
                                <input type="text" class="holiday-name-input" id="holidayNameCompact"
                                    placeholder="e.g., Independence Day">
                            </div>

                            <!-- Holiday Type Selection -->
                            <div class="form-section">
                                <label class="form-label">Holiday Type</label>
                                <div class="holiday-type-selector">
                                    <label class="type-option">
                                        <input type="radio" name="holidayType" value="custom" checked
                                            onchange="toggleHolidayType('custom')">
                                        <span>ğŸ‰ Custom Holiday</span>
                                    </label>
                                    <label class="type-option">
                                        <input type="radio" name="holidayType" value="public"
                                            onchange="toggleHolidayType('public')">
                                        <span>ğŸ›ï¸ Public Holiday</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Region Selection (hidden by default) -->
                            <div class="form-section" id="regionSection" style="display: none;">
                                <label class="form-label">Region</label>
                                <div class="region-selector">
                                    <label class="region-option">
                                        <input type="radio" name="region" value="US" checked
                                            onchange="updateCompactPreview()">
                                        <span>ğŸ‡ºğŸ‡¸ United States</span>
                                    </label>
                                    <label class="region-option">
                                        <input type="radio" name="region" value="UK" onchange="updateCompactPreview()">
                                        <span>ğŸ‡¬ğŸ‡§ United Kingdom</span>
                                    </label>
                                    <label class="region-option">
                                        <input type="radio" name="region" value="IN" onchange="updateCompactPreview()">
                                        <span>ğŸ‡®ğŸ‡³ India</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Multi-Date Calendar -->
                            <div class="form-section">
                                <label class="form-label">Select Dates (click to toggle)</label>
                                <div class="compact-multi-calendar">
                                    <div class="compact-calendar-nav">
                                        <button type="button" id="compactPrevMonth" class="compact-nav-btn">â€¹</button>
                                        <span id="compactMonthYearDisplay" class="compact-month-year-label"></span>
                                        <button type="button" id="compactNextMonth" class="compact-nav-btn">â€º</button>
                                    </div>
                                    <div class="calendar-grid" id="compactCalendarGrid">
                                        <!-- Calendar will be generated here -->
                                    </div>
                                    <div class="selected-dates-display" id="compactSelectedDatesDisplay">
                                        <span class="selected-count">0 dates selected</span>
                                        - Click dates above to select
                                    </div>
                                </div>
                            </div>

                            <!-- Create Button -->
                            <button class="create-button" id="compactCreateButton" onclick="createCompactHoliday()">
                                Create Holiday
                            </button>
                        </div>

                        <!-- Split layout for Custom and Public holidays -->
                        <div class="admin-form-group">
                            <div class="holidays-split-container">
                                <!-- Left side: Custom Holidays -->
                                <div class="holidays-left-panel">
                                    <label class="admin-form-label">Custom Holidays</label>
                                    <div id="existingHolidaysList" class="admin-member-list">
                                        <!-- Will be populated dynamically -->
                                    </div>
                                </div>

                                <!-- Right side: Public Holidays -->
                                <div class="holidays-right-panel">
                                    <div class="public-holidays-header">
                                        <label class="admin-form-label">Public Holidays</label>
                                        <div class="region-filter-buttons">
                                            <button class="region-filter-btn active" data-region="all"
                                                onclick="filterPublicHolidays('all')">All</button>
                                            <button class="region-filter-btn" data-region="US"
                                                onclick="filterPublicHolidays('US')">ğŸ‡ºğŸ‡¸ US</button>
                                            <button class="region-filter-btn" data-region="UK"
                                                onclick="filterPublicHolidays('UK')">ğŸ‡¬ğŸ‡§ UK</button>
                                            <button class="region-filter-btn" data-region="IN"
                                                onclick="filterPublicHolidays('IN')">ğŸ‡®ğŸ‡³ IN</button>
                                        </div>
                                    </div>
                                    <div id="publicHolidaysList" class="admin-member-list">
                                        <!-- Will be populated dynamically -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div> <!-- Special Dates Mode -->
                    <!-- Team Members Mode -->
                    <div id="members-admin" class="admin-mode-pane">
                        <h3 style="margin-bottom: 20px; color: #1e293b; display: flex; align-items: center; gap: 8px;">
                            ğŸ‘¥ Team Members Management
                        </h3>
                        <!-- Add Member -->
                        <div class="admin-form-row" style="margin-bottom: 20px;">
                            <div style="flex: 1;">
                                <label class="admin-form-label">Add New Member</label>
                                <input type="text" id="newMemberNameAdvanced" class="admin-form-input"
                                    placeholder="Enter member name...">
                            </div>
                            <button id="addMemberAdvanced" class="admin-btn admin-btn-primary">Add Member</button>
                        </div>
                        <!-- Current Members List -->
                        <div class="admin-form-group">
                            <label class="admin-form-label">Current Team Members</label>
                            <div id="currentMembersList" class="admin-member-list">
                                <!-- Will be populated dynamically -->
                            </div>
                        </div>
                        <div class="admin-form-group"
                            style="margin-top: 30px; border-top: 1px solid #e2e8f0; padding-top: 20px;">
                            <label class="admin-form-label">Member Role Management</label>
                            <div class="admin-form-row" style="margin-bottom: 15px;">
                                <div style="flex: 1;">
                                    <select id="profileMemberSelect" class="admin-form-input"
                                        onchange="loadMemberRole()">
                                        <option value="">Select member to edit role...</option>
                                    </select>
                                </div>
                                <div style="flex: 1;">
                                    <input type="text" id="memberRoleInput" class="admin-form-input"
                                        placeholder="e.g., Senior Manager, Developer..." disabled>
                                </div>
                                <button onclick="saveMemberRole()" class="admin-btn admin-btn-primary" id="saveRoleBtn"
                                    disabled>
                                    Save Role
                                </button>
                            </div>
                            <!-- NEW: Photo uploaded checkbox -->
                            <label style="display:flex;align-items:center;gap:8px;margin-top:10px;">
                                <input type="checkbox" id="memberPhotoCheckbox">
                                Photo uploaded for this member
                            </label>
                            <div style="font-size: 0.85rem; color: #64748b; margin-top: 8px;">
                                Profile photos: Upload [member-name].jpeg to assets/team-photos/ folder (e.g.,
                                john-doe.jpeg)
                            </div>
                        </div>
                    </div>

                    <!-- Special Dates Mode -->
                    <div id="special-admin" class="admin-mode-pane">
                        <h3 style="margin-bottom: 20px; color: #1e293b; display: flex; align-items: center; gap: 8px;">
                            ğŸ‚ Special Dates (Birthdays & Anniversaries)
                        </h3>
                        <!-- Add Special Date - UPDATED FORM -->
                        <div class="admin-form-row" style="margin-bottom: 20px;">
                            <div style="flex: 1;">
                                <label class="admin-form-label">Team Member</label>
                                <select id="specialDateMember" class="admin-form-input">
                                    <option value="">Select member...</option>
                                    <!-- Will be populated dynamically -->
                                </select>
                            </div>
                            <div style="flex: 1;">
                                <label class="admin-form-label">Type</label>
                                <select id="specialDateType" class="admin-form-input" onchange="toggleDateFields()">
                                    <option value="birthday">ğŸ‚ Birthday</option>
                                    <option value="anniversary">ğŸŠ Work Anniversary</option>
                                </select>
                            </div>
                        </div>
                        <!-- Birthday Date Field -->
                        <div class="admin-form-row" id="birthdayDateRow" style="margin-bottom: 20px;">
                            <div style="flex: 1;">
                                <label class="admin-form-label">Birthday Date</label>
                                <input type="date" id="birthdayDateInput" class="admin-form-input">
                            </div>
                            <div style="flex: 1;"></div>
                            <!-- Spacer -->
                            <button id="addSpecialDate" class="admin-btn admin-btn-primary">Add Birthday</button>
                        </div>
                        <!-- Anniversary Fields -->
                        <div class="admin-form-row" id="anniversaryDateRow" style="margin-bottom: 20px; display: none;">
                            <div style="flex: 1;">
                                <label class="admin-form-label">Start Year</label>
                                <select id="anniversaryYearInput" class="admin-form-input">
                                    <!-- Will be populated with years --></select>
                            </div>
                            <div style="flex: 1;">
                                <label class="admin-form-label">Anniversary Date (Month/Day)</label>
                                <input type="date" id="anniversaryDateInput" class="admin-form-input">
                            </div>
                            <button id="addAnniversary" class="admin-btn admin-btn-primary">Add Anniversary</button>
                        </div>
                        <!-- Existing Special Dates -->
                        <div class="admin-form-group">
                            <label class="admin-form-label">Current Special Dates</label>
                            <div id="specialDatesList" class="admin-member-list">
                                <!-- Will be populated dynamically -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Side Panel â€“ Accordion Version -->
        <div id="floatingPanel">
            <!-- Panel Header -->
            <div class="panel-main-header" onclick="toggleMainPanel()">
                <h3 class="panel-main-title">
                    ğŸ“Š Monthly Quick View
                </h3>
                <button class="panel-collapse-btn" id="mainPanelCollapseBtn">â€º</button>
            </div>
            <!-- Panel Content -->
            <div class="panel-main-content">
                <!-- Monthly Summary Accordion -->
                <div class="accordion-card" id="monthly-summary-card">
                    <div class="accordion-header" onclick="toggleAccordion('monthly-summary-card')">
                        <h4 class="accordion-title">
                            <span class="icon-only">ğŸ“…</span>
                            <span class="text-part">
                                ğŸ“… Monthly
                                Summary
                            </span>
                        </h4>
                        <span class="accordion-arrow">â–¶</span>
                    </div>
                    <div class="accordion-content">
                        <div class="metric-item">
                            <span class="metric-label">Total Leave Days</span>
                            <span class="metric-value" id="total-leave-metric">â€“</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Avg Days Off per Person</span>
                            <span class="metric-value" id="avg-leave-metric">â€“</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Peak Absence</span>
                            <span class="metric-value" id="peak-absence-metric">â€“</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Days with Low Availability</span>
                            <span class="metric-value" id="low-avail-metric">â€“</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Lowest Availability Day</span>
                            <span class="metric-value" id="lowest-day-metric">â€“</span>
                        </div>
                    </div>
                </div>
                <!-- Public Holidays Accordion -->
                <div class="accordion-card" id="holidays-card">
                    <div class="accordion-header" onclick="toggleAccordion('holidays-card')">
                        <h4 class="accordion-title">
                            <span class="icon-only">ğŸ‰</span>
                            <span class="text-part">
                                ğŸ‰ Public
                                Holidays
                            </span>
                            <span class="accordion-arrow">â–¶</span>
                    </div>
                    <div class="accordion-content">
                        <div id="holiday-list-new">
                            <!-- Holidays will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
                <!-- Team Stats Accordion -->
                <div class="accordion-card" id="team-stats-card">
                    <div class="accordion-header" onclick="toggleAccordion('team-stats-card')">
                        <h4 class="accordion-title">
                            <span class="icon-only">ğŸ‘¥</span>
                            <span class="text-part">ğŸ‘¥ Team Stats</span>
                            <span class="accordion-arrow">â–¶</span>
                    </div>
                    <div class="accordion-content">
                        <div class="metric-item">
                            <span class="metric-label">Top Leave Takers</span>
                            <span class="metric-value" id="top-members-metric">â€“</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Least Leave Takers</span>
                            <span class="metric-value" id="least-members-metric">â€“</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">No Leave Takers</span>
                            <span class="metric-value" id="no-leave-metric">â€“</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Off Today</span>
                            <span class="metric-value" id="off-today-metric">â€“</span>
                        </div>
                    </div>
                </div>
                <!-- Member Cards Accordion -->
                <div class="accordion-card" id="member-cards-card">
                    <div class="accordion-header" onclick="toggleAccordion('member-cards-card')">
                        <h4 class="accordion-title">
                            <span class="icon-only">ğŸƒ</span>
                            <span class="text-part">
                                ğŸƒ Team Member
                                Cards
                            </span>
                            <span class="accordion-arrow">â–¶</span>
                    </div>
                    <div class="accordion-content">
                        <div class="swiper mySwiper">
                            <div class="swiper-wrapper" id="swiperWrapper"></div>
                            <div class="swiper-pagination"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="toast" class="toast" hidden></div>

</body>

</html>